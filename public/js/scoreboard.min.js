function htmlEncode(value){return $("<div/>").text(value).html()}var blink_val=0,blink;$(document).ready(function(){$("#console").draggable({cursor:"crosshair",drag:function(event,ui){ui.position.top<$("#navbar").height()&&(ui.position.top=$("#navbar").height()),ui.position.left<0&&(ui.position.left=0)}}),$("#console").on("blink",function(){clearInterval(blink),blink=setInterval(function(){0===blink_val?($("#blinkCursor").css("background-color","#aaa"),$("#blinkCursor").css("color","#000"),blink_val=1):($("#blinkCursor").css("background-color","#000"),$("#blinkCursor").css("color","#aaa"),blink_val=0)},500)}),$("#console").trigger("blink")}),sock.on("message",function(data){if(2===data.submit)$(".new_line").last().teletype({animDelay:100,text:data.message},function(){$("#blinkCursor").remove(),$("#console").append($('<p class="new_line"></p>').text($("#team").text()+"@inso2k15$ ")),$(".new_line").last().append('<span id="blinkCursor">&nbsp;</span>'),$("#console").trigger("blink");var h=$("#console")[0].scrollHeight;$("#console").scrollTop(h)});else{$("#blinkCursor").remove(),$(".new_line").last().text($("#team").text()+"@inso2k15$ "+data.message),1===data.submit&&$("#console").append($('<p class="new_line"></p>').text($("#team").text()+"@inso2k15$ ")),$(".new_line").last().append('<span id="blinkCursor">&nbsp;</span>'),$("#console").trigger("blink");var h=$("#console")[0].scrollHeight;$("#console").scrollTop(h)}}),$.fn.teletype=function(opts,callback){clearInterval(blink),$("#blinkCursor").remove();var $this=this,defaults={animDelay:50},settings=$.extend(defaults,opts);$.each(settings.text.split(""),function(i,letter){setTimeout(function(){$this.html($this.html()+letter)},settings.animDelay*i)}),setTimeout(function(){setTimeout(function(){$(".new_line").last().append('<span id="blinkCursor">&nbsp;</span>'),$("#console").trigger("blink"),callback()},100)},settings.animDelay*settings.text.length)},sock.on("giveMessages",function(messages){$("#blinkCursor").remove(),messages.forEach(function(message){var date=new Date(message.timestamp),seconds=date.getSeconds(),minutes=date.getMinutes(),hours=date.getHours();$("#console").append($('<p class="new_line"></p>').text("<"+hours+":"+minutes+":"+seconds+"> "+message.content))}),$("#console").append($('<p class="new_line"></p>').text($("#team").text()+"@inso2k15$ ")),$(".new_line").last().append('<span id="blinkCursor">&nbsp;</span>'),$("#console").trigger("blink");var h=$("#console")[0].scrollHeight;$("#console").scrollTop(h)}),$(document).ready(function(){$("#console").append('<p class="new_line">$ </p>'),setTimeout(function(){$(".new_line").last().teletype({animDelay:50,text:"ssh "+$("#team").text()+"@inso2k15"},function(){$("#console").append($('<p class="new_line"></p>').text($("#team").text()+"@inso2k15's password:")),setTimeout(function(){$(".new_line").last().teletype({animDelay:100,text:"**********"},function(){$("#console").append('<p class="new_line">Welcome on Insomni\'hack communicator</p>'),setTimeout(function(){$("#console").append($('<p class="new_line"></p>').text($("#team").text()+"@inso2k15$ ")),$(".new_line").last().teletype({animDelay:100,text:"cat /var/log/messages"},function(){sock.emit("getMessages")})},1e3)})},1e3)})},1e3)}),$(document).ready(function(){$("#pad").draggable({cursor:"crosshair",handle:".titleBar",drag:function(event,ui){ui.position.top<$("#navbar").height()&&(ui.position.top=$("#navbar").height()),ui.position.left<0&&(ui.position.left=0)}}),$("#pad").resizable(),sock.on("validation",function(){sock.emit("getScoreboard")}),sock.on("updateTeams",function(){sock.emit("getScoreboard")}),sock.emit("getScoreboard"),sock.on("giveScoreboard",function(scoreboard){$("#scoreboard").html('<div class="line head"><div class="column pos">Pos</div><div class="column team">Team</div><div class="column score">Score</div><div class="column bt">Breakthrough</div></div>');var lineDiv,posDiv,teamDiv,scoreDiv,lastDiv,time,pos=1;scoreboard.forEach(function(line){lineDiv=$("<div></div>"),lineDiv.addClass("line"),posDiv=$("<div></div>"),posDiv.addClass("column"),posDiv.addClass("pos"),posDiv.text(pos),pos+=1,teamDiv=$("<div></div>"),teamDiv.addClass("column"),teamDiv.addClass("team"),teamDiv.text(line.team),scoreDiv=$("<div></div>"),scoreDiv.addClass("column"),scoreDiv.addClass("score"),scoreDiv.text(line.score),lastDiv=$("<div></div>"),lastDiv.addClass("column"),lastDiv.addClass("bt"),time=new Date(-line.time);for(var i=0;i<line.breakthrough;i++)lastDiv.append('<img src="/img/coeur.png">');lineDiv.append(posDiv),lineDiv.append(teamDiv),lineDiv.append(scoreDiv),lineDiv.append(lastDiv),$("#scoreboard").append(lineDiv)})})});